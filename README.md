# myshop

## Описание
Интернет-магазин myshop.
Данный сайт предоставляет возможность онлайн продажи товаров. После добавления товаров в корзину и резервирования заказа, пользователи могут совершить оплату через Stripe с отображением статуса заказа в реальном времени. Рассылка по заказам приходит на почту, указанную пользователем при регистрации (с применением Celery/RabbitMQ). Также сервис предоставляет возможность печати инвойсов, экспорта заказов в CSV-файлы и применения к заказу купонов на скидку. Рекомендации товаров для пользователя предоставляются с помощью Redis.

Чтобы локально клонировать проект, следует выполнить команду:
```
git clone https://github.com/agorlenko2/myshop.git
```
После этого в папке проекта следует создать виртуальную среду:
```
python -m venv venv
```
и установить зависимости проекта:
```
pip install -r requirements.txt
```
Для корректной работы приложения также требуется в папке проекта создать .env-файл, в котором следует указать настройки:
* SECRET_KEY - секретный ключ Django;
* EMAIL_HOST - хост учетной записи почты, с которой производится рассылка писем;
* EMAIL_HOST_USER - почтовый адрес, с которого производится рассылка писем;
* EMAIL_HOST_PASSWORD - пароль от почтового адреса, с которого производится рассылка писем;
* EMAIL_PORT - почтовый порт;
* STRIPE_PUBLISHABLE_KEY - публикуемый API-ключ Stripe для тестовой среды;
* STRIPE_SECRET_KEY - секретный API-ключ Stripe для производственной среды;
* STRIPE_API_VERSION - используемая версия API Stripe, по-умолчанию: '2022-08-01';
* STRIPE_WEBHOOK_SECRET - секретный эндпоинт вебхука Stripe;
* REDIS_HOST - хост для запуска Redis;
* REDIS_PORT - порт для запуска Redis;
* REDIS_DB - хранилище Redis.

Для запуска следует скачать Docker-образы Redis и RabbitMQ с помощью команд:
```
docker pull redis
```
и
```
docker pull rabbitmq
```

Запуск контейнеров Redis и RabbitMQ производится с помощью команд:
```
docker run -it --rm --name redis -p 6379:6379 redis
```
и
```
docker run -it --rm --name rabbitmq -p 5672:5672 -p 15672:15672 rabbitmq:management
```

Запуск celery производится из папки проекта с помощью команды:
```
celery -A proj worker -l info --pool==solo
```
Локальный запуск приложения производится с помощью запуска в папке проекта команды 
```
python manage.py runserver
```
